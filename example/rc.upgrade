#!/bin/sh

# example script that shows how to upgrade a running rund
# without rebooting

function failed
{
	echo "FAIL $@"
	exit 1
}

SVCS=/tmp/$$

# save state
runcl -q status > $SVCS || failed "Get current status"

# exec new version
runcl -q exec rund -noinit || failed "Exec new rund"

# restore state
while read ARGS; do
	runcl -q add $ARGS || echo "WARN: import $ARGS failed"
done
exit 0
